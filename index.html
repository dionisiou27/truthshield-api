<!DOCTYPE html>
<html>
<head>
    <title>TruthShield Demo</title>
    <style>
        body { font-family: Arial; margin: 40px; background: #f0f2f6; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; }
        .header { text-align: center; margin-bottom: 30px; }
        .demo-section { border: 1px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 8px; }
        .metrics { display: flex; gap: 20px; }
        .metric { background: #e8f4fd; padding: 15px; border-radius: 5px; flex: 1; text-align: center; }
        button { background: #ff4b4b; color: white; padding: 12px 24px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #ff6b6b; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .response { background: #d4edda; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .loading { background: #fff3cd; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .error { background: #f8d7da; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .json-details { background: #f8f9fa; padding: 10px; border-radius: 5px; font-family: monospace; font-size: 12px; max-height: 200px; overflow-y: auto; }
        
        /* Language toggle button styles */
        .lang-toggle {
            background: #2196F3;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        .lang-toggle:hover {
            background: #1976D2;
        }
        .lang-toggle.german {
            background: #2196F3;
        }
        .lang-toggle.english {
            background: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üõ°Ô∏è TruthShield</h1>
            <h2>AI-powered fact-checking service for enterprises</h2>
            <p><strong>Protecting European Democracy Through German Innovation</strong></p>
            <p style="color: green;">‚úÖ <strong>LIVE API DEMO</strong> - Connected to real AI!</p>
        </div>

        <div class="demo-section">
            <h3>üîç Live AI Fact-Checking Demo</h3>
            <textarea id="fakeNews" placeholder="Enter potential misinformation (e.g., BMW EVs explode in winter)" style="width: 100%; height: 80px; margin: 10px 0; padding: 10px;"></textarea>
            
            <select id="company" style="margin: 10px 0; padding: 8px;">
                <option value="BMW">BMW</option>
                <option value="Vodafone">Vodafone</option>
                <option value="Bayer">Bayer</option>
                <option value="Siemens">Siemens</option>
            </select>
            
            <br><button id="analyzeBtn" onclick="analyzeWithRealAI()">üöÄ Analyze with Real AI</button>
            
            <div id="results" style="display: none; margin-top: 20px;">
                <h4>‚úÖ Analysis Complete!</h4>
                <div id="responseSection" class="response">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                        <h4 style="margin: 0;">ü§ñ <span id="companyName"></span> AI Response:</h4>
                        <button id="langToggle" class="lang-toggle german" onclick="toggleLanguage()">
                            üá©üá™ Deutsch
                        </button>
                    </div>
                    <p id="botResponseEN" style="display: none;"></p>
                    <p id="botResponseDE"></p>
                    <p><strong>Confidence / Vertrauen:</strong> <span id="confidence"></span>%</p>
                    <p><strong>Category / Kategorie:</strong> <span id="categoryEN" style="display: none;"></span><span id="categoryDE"></span></p>
                    <p><strong>Sources Found / Gefundene Quellen:</strong> <span id="sourcesCount"></span></p>
                </div>
                <div class="metrics">
                    <div class="metric">
                        <h4>Processing Time</h4>
                        <p><strong id="processingTime">-</strong><br><small>Real AI processing</small></p>
                    </div>
                    <div class="metric">
                        <h4>AI Technology</h4>
                        <p><strong>GPT-4</strong><br><small>OpenAI + Web Search</small></p>
                    </div>
                    <div class="metric">
                        <h4>Request ID</h4>
                        <p><strong id="requestId">-</strong><br><small>for tracking</small></p>
                    </div>
                </div>
                
                <details style="margin-top: 15px;">
                    <summary><strong>üîç Technical Details (JSON Response)</strong></summary>
                    <div id="jsonResponse" class="json-details"></div>
                </details>
            </div>
            
            <div id="loading" class="loading" style="display: none;">
                <p>ü§ñ <strong>AI Processing...</strong> Please wait 10-30 seconds</p>
                <p>üîç Analyzing claim with GPT-4...</p>
                <p>üåê Searching web sources...</p>
                <p>‚ú® Generating brand response...</p>
            </div>
            
            <div id="error" class="error" style="display: none;">
                <h4>‚ùå Error</h4>
                <p id="errorMessage"></p>
            </div>
        </div>

        <div class="demo-section">
            <h3>üíº Enterprise Solution</h3>
            <div style="display: flex; gap: 20px;">
                <div style="flex: 1;">
                    <h4>üéØ Target Market</h4>
                    <ul>
                        <li>DAX 40 companies</li>
                        <li>Large Mittelstand</li>
                        <li>EU expansion ready</li>
                        <li>‚Ç¨150M TAM</li>
                    </ul>
                </div>
                <div style="flex: 1;">
                    <h4>üí∞ Pricing</h4>
                    <ul>
                        <li><strong>Setup:</strong> ‚Ç¨50K per customer</li>
                        <li><strong>Monthly:</strong> ‚Ç¨25K per company</li>
                        <li><strong>Annual Value:</strong> ‚Ç¨350K</li>
                        <li><strong>ROI:</strong> 30:1 LTV:CAC</li>
                    </ul>
                </div>
                <div style="flex: 1;">
                    <h4>üöÄ Technology Stack</h4>
                    <ul>
                        <li>OpenAI GPT-4 Integration</li>
                        <li>Real-time Web Scraping</li>
                        <li>FastAPI + Python Backend</li>
                        <li>EU Cloud Infrastructure</li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="text-align: center; margin-top: 30px;">
            <p><strong>TruthShield: German Engineering. European Values. Global Impact.</strong></p>
            <p>üîó GitHub: <a href="https://github.com/dionisiou27/truthshield-api">github.com/dionisiou27/truthshield-api</a></p>
            <p>üìß Contact: contact@truthshield.eu</p>
            <p style="color: #666; font-size: 12px;">Demo requires local API server running on localhost:8000</p>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        let currentLanguage = 'de';  // Start with German
        let currentData = null;      // Store response data globally
        
        async function analyzeWithRealAI() {
            const text = document.getElementById('fakeNews').value;
            const company = document.getElementById('company').value;
            const analyzeBtn = document.getElementById('analyzeBtn');
            
            if (!text || text.length < 10) {
                alert('Please enter at least 10 characters to analyze!');
                return;
            }
            
            // Show loading state
            document.getElementById('results').style.display = 'none';
            document.getElementById('error').style.display = 'none';
            document.getElementById('loading').style.display = 'block';
            analyzeBtn.disabled = true;
            analyzeBtn.textContent = 'ü§ñ AI Processing...';
            
            try {
                const response = await fetch(`${API_BASE}/api/v1/detect/fact-check`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        text: text,
                        company: company,
                        language: "de",
                        generate_ai_response: true
                    })
                });
                
                if (!response.ok) {
                    throw new Error(`API Error: ${response.status} ${response.statusText}`);
                }
                
                const result = await response.json();
                currentData = result; // Store for language toggle
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
                // Show results
                displayResults(result, company);
                
            } catch (error) {
                console.error('API Error:', error);
                
                // Hide loading
                document.getElementById('loading').style.display = 'none';
                
                // Show error
                document.getElementById('error').style.display = 'block';
                document.getElementById('errorMessage').innerHTML = `
                    <strong>Failed to connect to TruthShield API</strong><br>
                    Make sure the API server is running on localhost:8000<br>
                    <small>Error: ${error.message}</small><br><br>
                    <strong>To start the API:</strong><br>
                    <code>uvicorn src.api.main:app --reload</code>
                `;
            } finally {
                // Reset button
                analyzeBtn.disabled = false;
                analyzeBtn.textContent = 'üöÄ Analyze with Real AI';
            }
        }
        
        function displayResults(result, company) {
            // Reset language to German
            currentLanguage = 'de';
            document.getElementById('langToggle').className = 'lang-toggle german';
            document.getElementById('langToggle').innerHTML = 'üá©üá™ Deutsch';
            
            // Display company name
            document.getElementById('companyName').textContent = company;
            
            // Extract bilingual responses from the API
            const enResponse = result.details?.ai_responses?.en || result.ai_response?.response_text || 'No English response generated';
            const deResponse = result.details?.ai_responses?.de || result.ai_response?.response_text || 'Keine deutsche Antwort generiert';
            
            // Set response texts
            document.getElementById('botResponseEN').textContent = enResponse;
            document.getElementById('botResponseDE').textContent = deResponse;
            
            // Display confidence
            document.getElementById('confidence').textContent = 
                Math.round((result.confidence || 0) * 100);
            
            // Display categories
            const categoryEN = result.fact_check?.category || 'Unknown';
            const categoryDE = result.details?.category_de || categoryEN;
            document.getElementById('categoryEN').textContent = categoryEN;
            document.getElementById('categoryDE').textContent = categoryDE;
            
            // Display sources count
            document.getElementById('sourcesCount').textContent = 
                result.details?.sources_found || 0;
            
            // Display metrics
            document.getElementById('processingTime').textContent = 
                `${result.processing_time_ms}ms`;
            document.getElementById('requestId').textContent = 
                result.request_id?.substring(0, 8) || 'Unknown';
            
            // Display JSON details
            document.getElementById('jsonResponse').textContent = 
                JSON.stringify(result, null, 2);
            
            // Show German version by default
            document.getElementById('botResponseEN').style.display = 'none';
            document.getElementById('botResponseDE').style.display = 'block';
            document.getElementById('categoryEN').style.display = 'none';
            document.getElementById('categoryDE').style.display = 'inline';
            
            // Show results section
            document.getElementById('results').style.display = 'block';
            
            // Scroll to results
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Language toggle function
        function toggleLanguage() {
            const toggleBtn = document.getElementById('langToggle');
            const responseEN = document.getElementById('botResponseEN');
            const responseDE = document.getElementById('botResponseDE');
            const categoryEN = document.getElementById('categoryEN');
            const categoryDE = document.getElementById('categoryDE');
            
            if (currentLanguage === 'de') {
                // Switch to English
                currentLanguage = 'en';
                toggleBtn.innerHTML = 'üá¨üáß English';
                toggleBtn.className = 'lang-toggle english';
                responseEN.style.display = 'block';
                responseDE.style.display = 'none';
                categoryEN.style.display = 'inline';
                categoryDE.style.display = 'none';
            } else {
                // Switch to German
                currentLanguage = 'de';
                toggleBtn.innerHTML = 'üá©üá™ Deutsch';
                toggleBtn.className = 'lang-toggle german';
                responseEN.style.display = 'none';
                responseDE.style.display = 'block';
                categoryEN.style.display = 'none';
                categoryDE.style.display = 'inline';
            }
        }
        
        // Add some sample texts for easy testing
        const sampleTexts = [
            "BMW Elektroautos explodieren bei Minusgraden",
            "Vodafone 5G towers cause cancer and mind control",
            "Bayer COVID vaccine contains tracking microchips",
            "Siemens wind turbines kill all birds in Germany"
        ];
        
        // Add quick test buttons
        document.addEventListener('DOMContentLoaded', function() {
            const textarea = document.getElementById('fakeNews');
            const container = textarea.parentNode;
            
            const quickTestDiv = document.createElement('div');
            quickTestDiv.style.marginTop = '10px';
            quickTestDiv.innerHTML = '<small><strong>Quick Tests:</strong></small><br>';
            
            sampleTexts.forEach((text, index) => {
                const btn = document.createElement('button');
                btn.textContent = `Test ${index + 1}`;
                btn.style.margin = '2px';
                btn.style.padding = '5px 10px';
                btn.style.fontSize = '12px';
                btn.onclick = () => {
                    textarea.value = text;
                    document.getElementById('company').value = ['BMW', 'Vodafone', 'Bayer', 'Siemens'][index];
                };
                quickTestDiv.appendChild(btn);
            });
            
            container.insertBefore(quickTestDiv, document.getElementById('company'));
        });
    </script>
</body>
</html>